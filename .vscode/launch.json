{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Generate ARM Template",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/generate_arm_template.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "--id",
                "test",
                "--name",
                "${input:testName}",
                "--manifest",
                "tests/${input:testName}/manifest.json",
                "--location",
                "${input:containerLocation}",
                "--security-policy",
                "${input:securityPolicy}",
                "--out",
                "tests/${input:testName}/arm_template.json"
            ]
        },
        {
            "name": "Add Security Policy To ARM Template",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/add_security_policy_to_arm_template.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "--arm-template-path",
                "${input:armTemplatePath}",
                "--security-policy-path",
                "${input:securityPolicyPath}",
            ]
        },
        {
            "name": "Deploy Container",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/deploy_container.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "--subscription-id",
                "${input:subscriptionId}",
                "--arm-template-path",
                "${input:armTemplatePath}",
                "--resource-group",
                "${input:resourceGroup}",
                "--deployment-name",
                "${input:containerName}",
            ]
        },
        {
            "name": "Remove Container",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/remove_container.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "--subscription-id",
                "${input:subscriptionId}",
                "--resource-group",
                "${input:resourceGroup}",
                "--container-name",
                "${input:containerName}",
                "--asynchronous",
            ]
        },
    ],
    "inputs": [
        {
            "id": "testName",
            "type": "pickString",
            "description": "Enter the name of the test:",
            "options": [
                "simple_server",
                "simple_sidecar",
                "attestation",
                "remote_image",
            ],
        },
        {
            "id": "containerName",
            "type": "promptString",
            "description": "Enter the name of the container:",
            "default": "simple-server",
        },
        {
            "id": "containerLocation",
            "type": "promptString",
            "description": "Enter the location of the container:",
            "default": "eastus2euap",
        },
        {
            "id": "containerImage",
            "type": "promptString",
            "description": "Enter the URL of image you want to deploy the container with:",
            "default": "caciexamples.azurecr.io/simple_server:latest",
        },
        {
            "id": "securityPolicy",
            "type": "pickString",
            "description": "Select the security policy to deploy with:",
            "options": [
                {
                    "label": "auto-policy",
                    "value": ""
                },
                {
                    "label": "allow-all",
                    "value": "cGFja2FnZSBwb2xpY3kKCmFwaV9zdm4gOj0gIjAuMTAuMCIKZnJhbWV3b3JrX3N2biA6PSAiMC4xLjAiCgptb3VudF9kZXZpY2UgOj0geyJhbGxvd2VkIjogdHJ1ZX0KbW91bnRfb3ZlcmxheSA6PSB7ImFsbG93ZWQiOiB0cnVlfQpjcmVhdGVfY29udGFpbmVyIDo9IHsiYWxsb3dlZCI6IHRydWUsICJhbGxvd19zdGRpb19hY2Nlc3MiOiB0cnVlfQp1bm1vdW50X2RldmljZSA6PSB7ImFsbG93ZWQiOiB0cnVlfQp1bm1vdW50X292ZXJsYXkgOj0geyJhbGxvd2VkIjogdHJ1ZX0KZXhlY19pbl9jb250YWluZXIgOj0geyJhbGxvd2VkIjogdHJ1ZX0KZXhlY19leHRlcm5hbCA6PSB7ImFsbG93ZWQiOiB0cnVlLCAiYWxsb3dfc3RkaW9fYWNjZXNzIjogdHJ1ZX0Kc2h1dGRvd25fY29udGFpbmVyIDo9IHsiYWxsb3dlZCI6IHRydWV9CnNpZ25hbF9jb250YWluZXJfcHJvY2VzcyA6PSB7ImFsbG93ZWQiOiB0cnVlfQpwbGFuOV9tb3VudCA6PSB7ImFsbG93ZWQiOiB0cnVlfQpwbGFuOV91bm1vdW50IDo9IHsiYWxsb3dlZCI6IHRydWV9CmdldF9wcm9wZXJ0aWVzIDo9IHsiYWxsb3dlZCI6IHRydWV9CmR1bXBfc3RhY2tzIDo9IHsiYWxsb3dlZCI6IHRydWV9CnJ1bnRpbWVfbG9nZ2luZyA6PSB7ImFsbG93ZWQiOiB0cnVlfQpsb2FkX2ZyYWdtZW50IDo9IHsiYWxsb3dlZCI6IHRydWV9CnNjcmF0Y2hfbW91bnQgOj0geyJhbGxvd2VkIjogdHJ1ZX0Kc2NyYXRjaF91bm1vdW50IDo9IHsiYWxsb3dlZCI6IHRydWV9Cg=="
                },
            ]
        },
        {
            "id": "outputFile",
            "type": "promptString",
            "description": "Enter the path to emit the output to (Leave blank to not emit file):",
            "default": "tests/simple_server/arm_template.json"
        },
        {
            "id": "armTemplatePath",
            "type": "promptString",
            "description": "Enter the path to the ARM Template to add the Security Policy to:",
            "default": "tests/simple_server/arm_template.json"
        },
        {
            "id": "securityPolicyPath",
            "type": "promptString",
            "description": "Enter the path to Security Policy file:",
            "default": "tests/simple_server/security_policy.rego"
        },
        {
            "id": "subscriptionId",
            "type": "promptString",
            "description": "Enter the subscription ID to use for deployment (Leave blank to use environment):",
        },
        {
            "id": "resourceGroup",
            "type": "promptString",
            "description": "Enter the resource group to use for deployment (Leave blank to use environment):",
        },
    ]
}