{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Set Credentials",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/credentials.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "--subscription-id",
                "${input:subscriptionId}",
                "--resource-group",
                "${input:resourceGroup}",
                "--registry-password",
                "${input:containerRegistryPassword}",
            ]
        },
        {
            "name": "Build Image",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/images.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "${input:dockerFilePath}",
                "--tag",
                "${input:imageTag}"
            ]
        },
        {
            "name": "Build And Push Image",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/images.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "${input:dockerFilePath}",
                "--tag",
                "${input:imageTag}",
                "--registry",
                "${input:containerRegistry}",
                "--registry-password",
                "${input:containerRegistryPassword}",
                "--repository",
                "${input:containerRepository}",
                "--push-tag",
                "${input:registryTag}",
            ]
        },
        {
            "name": "Deploy ACI",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/containers.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "deploy",
                "--subscription-id",
                "${input:subscriptionId}",
                "--resource-group",
                "${input:resourceGroup}",
                "--name",
                "${input:containerName}",
                "--image",
                "${input:containerImage}",
                "--registry-password",
                "${input:containerRegistryPassword}",
                "--security-policy",
                "${input:securityPolicy}",
                "--arm-out",
                "tests/simple_server/arm_template.json"
            ]
        },
        {
            "name": "Get ACI IP",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/containers.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "get_ip",
                "--subscription-id",
                "${input:subscriptionId}",
                "--resource-group",
                "${input:resourceGroup}",
                "--name",
                "${input:containerName}",
            ]
        },
        {
            "name": "Remove ACI",
            "type": "python",
            "request": "launch",
            "program": "${workspaceFolder}/infra/containers.py",
            "console": "integratedTerminal",
            "justMyCode": true,
            "args": [
                "remove",
                "--subscription-id",
                "${input:subscriptionId}",
                "--resource-group",
                "${input:resourceGroup}",
                "--name",
                "${input:containerName}",
            ]
        },
    ],
    "inputs": [
        {
            "id": "subscriptionId",
            "type": "promptString",
            "description": "Enter the subscription ID to use for deployment (Leave blank to use environment):",
        },
        {
            "id": "resourceGroup",
            "type": "promptString",
            "description": "Enter the resource group to use for deployment (Leave blank to use environment):",
        },
        {
            "id": "containerName",
            "type": "promptString",
            "description": "Enter the name of the container:",
            "default": "simple-server",
        },
        {
            "id": "containerImage",
            "type": "promptString",
            "description": "Enter the URL of image you want to deploy the container with:",
            "default": "caciexamples.azurecr.io/simple_server:latest",
        },
        {
            "id": "dockerFilePath",
            "type": "promptString",
            "description": "Enter the relative path to the dockerfile build the image with:",
            "default": "tests/simple_server/Dockerfile",
        },
        {
            "id": "imageTag",
            "type": "promptString",
            "description": "Enter the tag to use for the built image:",
            "default": "simple_server"
        },
        {
            "id": "containerRegistry",
            "type": "promptString",
            "description": "Enter the container registry to push the image to:",
            "default": "caciexamples.azurecr.io"
        },
        {
            "id": "containerRegistryPassword",
            "type": "promptString",
            "description": "Enter the password for the selected container registry (Leave blank to use environment):",
        },
        {
            "id": "containerRepository",
            "type": "promptString",
            "description": "Enter the repository to use for the built image:",
            "default": "simple_server"
        },
        {
            "id": "registryTag",
            "type": "promptString",
            "description": "Enter the tag to use in the container registry:",
            "default": "latest"
        },
        {
            "id": "securityPolicy",
            "type": "pickString",
            "description": "Select the security policy to deploy with:",
            "options": [
                {
                    "label": "allow-all",
                    "value": "cGFja2FnZSBwb2xpY3kKCmFwaV9zdm4gOj0gIjAuMTAuMCIKZnJhbWV3b3JrX3N2biA6PSAiMC4xLjAiCgptb3VudF9kZXZpY2UgOj0geyJhbGxvd2VkIjogdHJ1ZX0KbW91bnRfb3ZlcmxheSA6PSB7ImFsbG93ZWQiOiB0cnVlfQpjcmVhdGVfY29udGFpbmVyIDo9IHsiYWxsb3dlZCI6IHRydWUsICJhbGxvd19zdGRpb19hY2Nlc3MiOiB0cnVlfQp1bm1vdW50X2RldmljZSA6PSB7ImFsbG93ZWQiOiB0cnVlfQp1bm1vdW50X292ZXJsYXkgOj0geyJhbGxvd2VkIjogdHJ1ZX0KZXhlY19pbl9jb250YWluZXIgOj0geyJhbGxvd2VkIjogdHJ1ZX0KZXhlY19leHRlcm5hbCA6PSB7ImFsbG93ZWQiOiB0cnVlLCAiYWxsb3dfc3RkaW9fYWNjZXNzIjogdHJ1ZX0Kc2h1dGRvd25fY29udGFpbmVyIDo9IHsiYWxsb3dlZCI6IHRydWV9CnNpZ25hbF9jb250YWluZXJfcHJvY2VzcyA6PSB7ImFsbG93ZWQiOiB0cnVlfQpwbGFuOV9tb3VudCA6PSB7ImFsbG93ZWQiOiB0cnVlfQpwbGFuOV91bm1vdW50IDo9IHsiYWxsb3dlZCI6IHRydWV9CmdldF9wcm9wZXJ0aWVzIDo9IHsiYWxsb3dlZCI6IHRydWV9CmR1bXBfc3RhY2tzIDo9IHsiYWxsb3dlZCI6IHRydWV9CnJ1bnRpbWVfbG9nZ2luZyA6PSB7ImFsbG93ZWQiOiB0cnVlfQpsb2FkX2ZyYWdtZW50IDo9IHsiYWxsb3dlZCI6IHRydWV9CnNjcmF0Y2hfbW91bnQgOj0geyJhbGxvd2VkIjogdHJ1ZX0Kc2NyYXRjaF91bm1vdW50IDo9IHsiYWxsb3dlZCI6IHRydWV9Cg=="
                },
                {
                    "label": "simple-server",
                    "value": "cGFja2FnZSBwb2xpY3kKCmltcG9ydCBmdXR1cmUua2V5d29yZHMuZXZlcnkKaW1wb3J0IGZ1dHVyZS5rZXl3b3Jkcy5pbgoKYXBpX3N2biA6PSAiMC4xMC4wIgoKZnJhbWV3b3JrX3N2biA6PSAiMC4xLjAiCgpmcmFnbWVudHMgOj0gW3sKCSJmZWVkIjogIm1jci5taWNyb3NvZnQuY29tL2FjaS9hY2ktY2MtaW5mcmEtZnJhZ21lbnQiLAoJImluY2x1ZGVzIjogWyJjb250YWluZXJzIl0sCgkiaXNzdWVyIjogImRpZDp4NTA5OjA6c2hhMjU2OklfX2l1TDI1b1hFVkZkVFBfYUJMeF9lVDFSUEhiQ1FfRUNCUWZZWnB0OXM6OmVrdToxLjMuNi4xLjQuMS4zMTEuNzYuNTkuMS4zIiwKCSJtaW5pbXVtX3N2biI6ICIxLjAuMCIsCn1dCgpjb250YWluZXJzIDo9IFsKCXsKCQkiYWxsb3dfZWxldmF0ZWQiOiB0cnVlLAoJCSJhbGxvd19zdGRpb19hY2Nlc3MiOiB0cnVlLAoJCSJjb21tYW5kIjogWwoJCQkicHl0aG9uIiwKCQkJInBheWxvYWQucHkiLAoJCV0sCgkJImVudl9ydWxlcyI6IFsKCQkJewoJCQkJInBhdHRlcm4iOiAiUEFUSD0vdXNyL2xvY2FsL2JpbjovdXNyL2xvY2FsL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9zYmluOi91c3IvYmluOi9zYmluOi9iaW4iLAoJCQkJInJlcXVpcmVkIjogZmFsc2UsCgkJCQkic3RyYXRlZ3kiOiAic3RyaW5nIiwKCQkJfSwKCQkJewoJCQkJInBhdHRlcm4iOiAiTEFORz1DLlVURi04IiwKCQkJCSJyZXF1aXJlZCI6IGZhbHNlLAoJCQkJInN0cmF0ZWd5IjogInN0cmluZyIsCgkJCX0sCgkJCXsKCQkJCSJwYXR0ZXJuIjogIkdQR19LRVk9QTAzNUM4QzE5MjE5QkE4MjFFQ0VBODZCNjRFNjI4RjhENjg0Njk2RCIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJzdHJpbmciLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJQWVRIT05fVkVSU0lPTj0zLjExLjIiLAoJCQkJInJlcXVpcmVkIjogZmFsc2UsCgkJCQkic3RyYXRlZ3kiOiAic3RyaW5nIiwKCQkJfSwKCQkJewoJCQkJInBhdHRlcm4iOiAiUFlUSE9OX1BJUF9WRVJTSU9OPTIyLjMuMSIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJzdHJpbmciLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJQWVRIT05fU0VUVVBUT09MU19WRVJTSU9OPTY1LjUuMSIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJzdHJpbmciLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJQWVRIT05fR0VUX1BJUF9VUkw9aHR0cHM6Ly9naXRodWIuY29tL3B5cGEvZ2V0LXBpcC9yYXcvZDVjYjBhZmFmMjNiODUyMGYxYmJjZmVkNTIxMDE3YjRhOTVmNWMwMS9wdWJsaWMvZ2V0LXBpcC5weSIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJzdHJpbmciLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJQWVRIT05fR0VUX1BJUF9TSEEyNTY9Mzk0YmUwMGYxM2ZhMWI5YWFhNDdlOTExYmRiNTlhMDljM2IyOTg2NDcyMTMwZjMwYWEwYmZhZjdmMzk4MDYzNyIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJzdHJpbmciLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJURVJNPXh0ZXJtIiwKCQkJCSJyZXF1aXJlZCI6IGZhbHNlLAoJCQkJInN0cmF0ZWd5IjogInN0cmluZyIsCgkJCX0sCgkJCXsKCQkJCSJwYXR0ZXJuIjogIigoP2kpRkFCUklDKV8uKz0uKyIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJyZTIiLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJIT1NUTkFNRT0uKyIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJyZTIiLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJUKEUpP01QPS4rIiwKCQkJCSJyZXF1aXJlZCI6IGZhbHNlLAoJCQkJInN0cmF0ZWd5IjogInJlMiIsCgkJCX0sCgkJCXsKCQkJCSJwYXR0ZXJuIjogIkZhYnJpY1BhY2thZ2VGaWxlTmFtZT0uKyIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJyZTIiLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJIb3N0ZWRTZXJ2aWNlTmFtZT0uKyIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJyZTIiLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJJREVOVElUWV9BUElfVkVSU0lPTj0uKyIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJyZTIiLAoJCQl9LAoJCQl7CgkJCQkicGF0dGVybiI6ICJJREVOVElUWV9IRUFERVI9LisiLAoJCQkJInJlcXVpcmVkIjogZmFsc2UsCgkJCQkic3RyYXRlZ3kiOiAicmUyIiwKCQkJfSwKCQkJewoJCQkJInBhdHRlcm4iOiAiSURFTlRJVFlfU0VSVkVSX1RIVU1CUFJJTlQ9LisiLAoJCQkJInJlcXVpcmVkIjogZmFsc2UsCgkJCQkic3RyYXRlZ3kiOiAicmUyIiwKCQkJfSwKCQkJewoJCQkJInBhdHRlcm4iOiAiYXp1cmVjb250YWluZXJpbnN0YW5jZV9yZXN0YXJ0ZWRfYnk9LisiLAoJCQkJInJlcXVpcmVkIjogZmFsc2UsCgkJCQkic3RyYXRlZ3kiOiAicmUyIiwKCQkJfSwKCQldLAoJCSJleGVjX3Byb2Nlc3NlcyI6IFtdLAoJCSJpZCI6ICJjYWNpZXhhbXBsZXMuYXp1cmVjci5pby9zaW1wbGVfc2VydmVyOmxhdGVzdCIsCgkJImxheWVycyI6IFsKCQkJIjQzZDcyOTkyMTdkZWE5ZGI0YTIyOWY4YTVhZjExNGJiNDA5NjI1Y2Y2MjVlMDUxM2JjYTg0ODI4YTFjNjVhYTAiLAoJCQkiY2VmMzhjMWNiNzMzZDZlZGZhODUxMTQ2OTA4MjQ1NzQ4ZjBmNjllYmU0NTdkYzMwM2U5MmI5ZGFjYWI5ZTEzMiIsCgkJCSI2MDhmYzc3YmY1MjI0NTMzYzYzMjMzZGE2ZTRhZTkxOGMxNzdkMzU5MDk1ODBlMzg0OTEwNGYxMDMwYjQ1YzhjIiwKCQkJIjgwZTllODYzZDRmMjQ3NzdkYmE0ZjU4ZmE0ODJlMjU5ZjI5YmIzMDAwNjBiY2QyZGVlMWM3NDgzN2FhYjE4OTkiLAoJCQkiZDlkZjZlN2MxMjM0ZWM2ODRjZmE1N2Q1ZjdhNDE0YzQzMThjMzA0Mzg5ZjFjN2Q0ZjNmMTZmYTY4ZjQ4MjBmZiIsCgkJCSIzNjdiZmZlZDc0YmU3MzlhNTE3MTk4OGQwOWZiZWQ4OWJlMzZkNDZkNDY2NmIzMzQzYzNlMDJkYmUxZmM1NzcwIiwKCQkJImUyNDA2NjM5OTEwZWE1ZTJlY2I2N2E3YmNmNGU3ZWMyMDhhZmU0NWZmMzliOTUxNmEwYzA2OTQ4ZjNhOTlhM2UiLAoJCQkiMzlkZGM5NTQ0OWM3Zjk1ODk3N2ExNDZmZWIzMzIyM2FkM2Q2MDUyNzM4MjU4MzU1NDI4MGM4Y2RlNmQ5YWRjMCIsCgkJCSJiYjMwMjMzYjQ2NmEwZTcwZDU2ODAwZTlhMTEyMWUzODIwOWQ2YzJlOWZjYTViMDBkZjVkODA2NTA5N2FlODM2IiwKCQkJIjcyMTM0ODA4MGViMjhkYzRlMzM1NjBlY2M3ZjJiNmE2YTgyODBmMzU1NmEyZjhmYTQ5OGZjNWZiMTc3NDJiYjAiLAoJCQkiNWRhMzFlNzE2ZDg4N2MxMjQ3NzNjZWZjZjg3MjY0OTk2MGE4OGI4MTdhNGIyYWU5ZGUxNTYwMzE4YjhiMzQ1OCIsCgkJXSwKCQkibW91bnRzIjogW3sKCQkJImRlc3RpbmF0aW9uIjogIi9ldGMvcmVzb2x2LmNvbmYiLAoJCQkib3B0aW9ucyI6IFsKCQkJCSJyYmluZCIsCgkJCQkicnNoYXJlZCIsCgkJCQkicnciLAoJCQldLAoJCQkic291cmNlIjogInNhbmRib3g6Ly8vdG1wL2F0bGFzL3Jlc29sdmNvbmYvLisiLAoJCQkidHlwZSI6ICJiaW5kIiwKCQl9XSwKCQkic2lnbmFscyI6IFtdLAoJCSJ3b3JraW5nX2RpciI6ICIvYXBwIiwKCX0sCgl7CgkJImFsbG93X2VsZXZhdGVkIjogZmFsc2UsCgkJImFsbG93X3N0ZGlvX2FjY2VzcyI6IHRydWUsCgkJImNvbW1hbmQiOiBbIi9wYXVzZSJdLAoJCSJlbnZfcnVsZXMiOiBbCgkJCXsKCQkJCSJwYXR0ZXJuIjogIlBBVEg9L3Vzci9sb2NhbC9zYmluOi91c3IvbG9jYWwvYmluOi91c3Ivc2JpbjovdXNyL2Jpbjovc2JpbjovYmluIiwKCQkJCSJyZXF1aXJlZCI6IHRydWUsCgkJCQkic3RyYXRlZ3kiOiAic3RyaW5nIiwKCQkJfSwKCQkJewoJCQkJInBhdHRlcm4iOiAiVEVSTT14dGVybSIsCgkJCQkicmVxdWlyZWQiOiBmYWxzZSwKCQkJCSJzdHJhdGVneSI6ICJzdHJpbmciLAoJCQl9LAoJCV0sCgkJImV4ZWNfcHJvY2Vzc2VzIjogW10sCgkJImxheWVycyI6IFsiMTZiNTE0MDU3YTA2YWQ2NjVmOTJjMDI4NjNhY2EwNzRmZDU5NzZjNzU1ZDI2YmZmMTYzNjUyOTkxNjllODQxNSJdLAoJCSJtb3VudHMiOiBbXSwKCQkic2lnbmFscyI6IFtdLAoJCSJ3b3JraW5nX2RpciI6ICIvIiwKCX0sCl0KCmFsbG93X3Byb3BlcnRpZXNfYWNjZXNzIDo9IGZhbHNlCgphbGxvd19kdW1wX3N0YWNrcyA6PSBmYWxzZQoKYWxsb3dfcnVudGltZV9sb2dnaW5nIDo9IGZhbHNlCgphbGxvd19lbnZpcm9ubWVudF92YXJpYWJsZV9kcm9wcGluZyA6PSB0cnVlCgphbGxvd191bmVuY3J5cHRlZF9zY3JhdGNoIDo9IGZhbHNlCgptb3VudF9kZXZpY2UgOj0gZGF0YS5mcmFtZXdvcmsubW91bnRfZGV2aWNlCgp1bm1vdW50X2RldmljZSA6PSBkYXRhLmZyYW1ld29yay51bm1vdW50X2RldmljZQoKbW91bnRfb3ZlcmxheSA6PSBkYXRhLmZyYW1ld29yay5tb3VudF9vdmVybGF5Cgp1bm1vdW50X292ZXJsYXkgOj0gZGF0YS5mcmFtZXdvcmsudW5tb3VudF9vdmVybGF5CgpjcmVhdGVfY29udGFpbmVyIDo9IGRhdGEuZnJhbWV3b3JrLmNyZWF0ZV9jb250YWluZXIKCmV4ZWNfaW5fY29udGFpbmVyIDo9IGRhdGEuZnJhbWV3b3JrLmV4ZWNfaW5fY29udGFpbmVyCgpleGVjX2V4dGVybmFsIDo9IGRhdGEuZnJhbWV3b3JrLmV4ZWNfZXh0ZXJuYWwKCnNodXRkb3duX2NvbnRhaW5lciA6PSBkYXRhLmZyYW1ld29yay5zaHV0ZG93bl9jb250YWluZXIKCnNpZ25hbF9jb250YWluZXJfcHJvY2VzcyA6PSBkYXRhLmZyYW1ld29yay5zaWduYWxfY29udGFpbmVyX3Byb2Nlc3MKCnBsYW45X21vdW50IDo9IGRhdGEuZnJhbWV3b3JrLnBsYW45X21vdW50CgpwbGFuOV91bm1vdW50IDo9IGRhdGEuZnJhbWV3b3JrLnBsYW45X3VubW91bnQKCmdldF9wcm9wZXJ0aWVzIDo9IGRhdGEuZnJhbWV3b3JrLmdldF9wcm9wZXJ0aWVzCgpkdW1wX3N0YWNrcyA6PSBkYXRhLmZyYW1ld29yay5kdW1wX3N0YWNrcwoKcnVudGltZV9sb2dnaW5nIDo9IGRhdGEuZnJhbWV3b3JrLnJ1bnRpbWVfbG9nZ2luZwoKbG9hZF9mcmFnbWVudCA6PSBkYXRhLmZyYW1ld29yay5sb2FkX2ZyYWdtZW50CgpzY3JhdGNoX21vdW50IDo9IGRhdGEuZnJhbWV3b3JrLnNjcmF0Y2hfbW91bnQKCnNjcmF0Y2hfdW5tb3VudCA6PSBkYXRhLmZyYW1ld29yay5zY3JhdGNoX3VubW91bnQKCnJlYXNvbiA6PSB7ImVycm9ycyI6IGRhdGEuZnJhbWV3b3JrLmVycm9yc30K"
                },
            ]
        },
    ]
}